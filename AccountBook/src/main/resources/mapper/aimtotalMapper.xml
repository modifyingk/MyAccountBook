<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aimtotalMapper">
	<!-- 전체 목표 값(aimtotal) 가져오기 -->
	<select id="selectTotal" parameterType="aimtotalVO" resultType="String">
		select total from aimtotal where moneytype = #{moneytype} and userid = #{userid};
	</select>

	<!-- 전체 목표 값(aimtotal) 추가 -->
	<insert id="insertTotal" parameterType="aimtotalVO">
		insert into aimtotal values (#{moneytype}, #{total}, #{userid});
	</insert>
	
	<!-- 전체 목표 값(aimtotal) 수정 -->
	<update id="updateTotal" parameterType="aimtotalVO">
		update aimtotal set total = #{total} where moneytype = #{moneytype} and userid = #{userid};
	</update>
	
	<!-- 분배 가능한 금액 -->
	<select id="selectBalance" parameterType="String" resultType="String">
		select (aimtotal.total - sum(aim.total)) as total from aim join aimtotal on aim.userid = aimtotal.userid
		where aim.userid = #{userid} and moneytype = "지출";
	</select>
</mapper>