<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="repeatMapper">
	<!-- 반복 추가 -->
	<insert id="insertRepeat" parameterType="repeatVO">
		insert into repetition values (#{repeatid}, #{repeatcycle}, #{date}, #{accountid}, #{userid});
		<selectKey keyProperty="repeatid" resultType="int" order="AFTER">
			select MAX(repeatid) from repetition;
		</selectKey>
	</insert>
	
	<!-- 반복 내역 가져오기 -->
	<select id="repeatList" parameterType="String" resultType="accountRepeatVO">
		select r.repeatid, repeatcycle, a.date, moneytype, assetid, assetname, catename, content, total from repetition r join account a on r.accountid = a.accountid where r.userid = #{userid};
	</select>
	
	<!--반복 삭제 -->
	<delete id="deleteRepeat" parameterType="repeatVO">
		delete from repetition where repeatid = #{repeatid} and userid = #{userid};
	</delete>
	
	<!--모든 반복 데이터 가져오기 --> 
	<select id="repeatAll" resultType="accountRepeatVO">
		select r.repeatid, repeatcycle, a.date, moneytype, assetid, assetname, catename, content, total, a.userid from repetition r join account a on r.accountid = a.accountid;
	</select>
</mapper>